---
title: Integrating DeFi with Actions SDK
description: Lend, Borrow, Swap, Pay in your app with a single dependency.
---

<Warning>
  Actions SDK is still under construction and not ready for production use! This guide is meant for early testing purposes only.
</Warning>

The [Actions SDK](https://actions.money/) is an open source Typescript development toolkit that simplifies the act of integrating DeFi into your application.

## How it works

Here's a breakdown of what's under the hood:

- **Modular Providers**: Actions is built with a set of core adapters called "Providers". Providers let you to pick an choose the right services and protocols for your use-case.

- **Embedded Wallets**: Actions supports popular embedded [wallet providers](https://actions.money/#wallet), allowing your users to access DeFi with email authentication flows alone.

- **Configure Actions**: Extend your embedded wallet with DeFi actions like Lend, Borrow, Swap, and Pay. Set multiple providers for each Action to choose the best markets across DeFi.

- **Customize assets & chains**: Allow and block assets, markets, chains, and protocols from your application from a single config.


## Installation

Install the Actions SDK in your project:

<CodeGroup>
```bash npm
npm install @eth-optimism/actions-sdk
```

```bash pnpm
pnpm add @eth-optimism/actions-sdk
```

```bash yarn
yarn add @eth-optimism/actions-sdk
```

```bash bun
bun add @eth-optimism/actions-sdk
```

```bash deno
deno add @eth-optimism/actions-sdk
```
</CodeGroup>

## Choose a Wallet Provider

Actions works with both frontend and backend wallets depending on your needs:

<Tabs>
  <Tab title="Frontend">
    Select a wallet provider:

    <Tabs>
      <Tab title="Privy">
        Install and setup [Privy](https://docs.privy.io/basics/react/installation).

        **Configure Wallet Provider**

        Give your embedded wallets the ability to take Action:

        ```typescript
        import { useWallets } from '@privy-io/react-auth'
        import { actions, USDC, ExampleMarket } from './config'

        // Fetch Privy embedded wallet
        const { wallets } = useWallets()
        const embeddedWallet = wallets.find(
          (wallet) => wallet.walletClientType === 'privy',
        )

        // Convert to Actions wallet
        const wallet = await actions.wallet.toActionsWallet({
          connectedWallet: embeddedWallet,
        })

        // Wallet can now take action
        const receipt = await wallet.lend.openPosition({
          amount: 100,
          asset: USDC,
          ...ExampleMarket
        })
        ```

        **Configure Smart Wallets**

        Optionally, create signers for smart wallets you control:

        ```typescript
        import { actions } from './config'
        import { useWallets } from '@privy-io/react-auth'

        // Fetch Privy embedded wallet
        const { wallets } = useWallets()
        const embeddedWallet = wallets.find(
          (wallet) => wallet.walletClientType === 'privy',
        )

        // Create signer from hosted wallet
        const signer = await actions.wallet.createSigner({
          connectedWallet: embeddedWallet,
        })

        // Create smart wallet
        const { wallet } = await actions.wallet.createSmartWallet({
          signer: signer
        })
        ```
      </Tab>

      <Tab title="Turnkey">
        Install and setup [Turnkey](https://docs.turnkey.com/sdks/react/getting-started).

        **Configure Wallet Provider**

        Give your embedded wallets the ability to take Action:

        ```typescript
        import { useTurnkey } from "@turnkey/react-wallet-kit"
        import { actions, USDC, ExampleMarket } from './config'

        // Create Turnkey wallet
        const { createWallet, httpClient, session } = useTurnkey()
        const embeddedWallet = await createWallet({
          walletName: `Wallet ${Math.random()}`,
          accounts: ["ADDRESS_FORMAT_ETHEREUM"],
        })

        const walletAddress = embeddedWallet.accounts[0].address

        // Convert to Actions wallet
        const wallet = await actions.wallet.toActionsWallet({
          client: httpClient,
          organizationId: session.organizationId,
          signWith: walletAddress,
          ethereumAddress: walletAddress,
        })

        // Wallet can now take action
        const receipt = await wallet.lend.openPosition({
          amount: 100,
          asset: USDC,
          ...ExampleMarket
        })
        ```

        **Configure Smart Wallets**

        Optionally, create signers for smart wallets you control:

        ```typescript
        import { useTurnkey } from "@turnkey/react-wallet-kit"
        import { actions } from './config'

        // Fetch Turnkey wallet
        const { wallets, httpClient, session } = useTurnkey()
        const embeddedWallet = wallets[0]
        const walletAddress = embeddedWallet.accounts[0].address

        // Create signer
        const signer = await actions.wallet.createSigner({
          client: httpClient,
          organizationId: session.organizationId,
          signWith: walletAddress,
        })

        // Create smart wallet
        const { wallet } = await actions.wallet.createSmartWallet({
          signer: signer
        })
        ```
      </Tab>

      <Tab title="Dynamic">
        Install and setup [Dynamic](https://www.dynamic.xyz/docs/wallets/embedded-wallets/mpc/setup).

        **Configure Wallet Provider**

        Give your embedded wallets the ability to take Action:

        ```typescript
        import { useDynamicContext } from "@dynamic-labs/sdk-react-core"
        import { actions, USDC, ExampleMarket } from './config'

        // Fetch Dynamic wallet
        const { primaryWallet } = useDynamicContext()

        // Convert to Actions wallet
        const wallet = await actions.wallet.toActionsWallet({
          wallet: primaryWallet,
        })

        // Wallet can now take action
        const receipt = await wallet.lend.openPosition({
          amount: 100,
          asset: USDC,
          ...ExampleMarket
        })
        ```

        **Configure Smart Wallets**

        Optionally, create signers for smart wallets you control:

        ```typescript
        import { useDynamicContext } from "@dynamic-labs/sdk-react-core"
        import { actions } from './config'

        // Fetch Dynamic wallet
        const { primaryWallet } = useDynamicContext()

        // Create signer
        const signer = await actions.wallet.createSigner({
          wallet: primaryWallet
        })

        // Create smart wallet
        const { wallet } = await actions.wallet.createSmartWallet({
          signer: signer
        })
        ```
      </Tab>
    </Tabs>
  </Tab>

  <Tab title="Backend">
    Select a wallet provider:

    <Tabs>
      <Tab title="Privy">
        Install and setup [Privy](https://docs.privy.io/basics/nodeJS/installation).

        **Configure Wallet Provider**

        Give your embedded wallets the ability to take Action:

        ```typescript
        import { PrivyClient } from '@privy-io/node'
        import { actions, USDC, ExampleMarket } from './config'

        const privyClient = new PrivyClient(
          process.env.PRIVY_APP_ID,
          process.env.PRIVY_APP_SECRET
        )

        // Create Privy wallet
        const privyWallet = await privyClient.walletApi.createWallet({
          chainType: 'ethereum',
        })

        // Convert to Actions wallet
        const wallet = await actions.wallet.toActionsWallet({
          walletId: privyWallet.id,
          address: privyWallet.address,
        })

        // Wallet can now take action
        const receipt = await wallet.lend.openPosition({
          amount: 100,
          asset: USDC,
          ...ExampleMarket
        })
        ```

        **Configure Smart Wallets**

        Optionally, create signers for smart wallets you control:

        ```typescript
        import { PrivyClient } from '@privy-io/node'
        import { getAddress } from 'viem'
        import { actions } from './config'

        // Create Privy wallet
        const privyWallet = await privyClient.walletApi.createWallet({
          chainType: 'ethereum',
        })

        // Create signer
        const signer = await actions.wallet.createSigner({
          walletId: privyWallet.id,
          address: getAddress(privyWallet.address),
        })

        // Create smart wallet
        const { wallet } = await actions.wallet.createSmartWallet({
          signer: signer
        })
        ```
      </Tab>

      <Tab title="Turnkey">
        Install and setup [Turnkey](https://docs.turnkey.com/sdks/javascript-server).

        **Configure Wallet Provider**

        Give your embedded wallets the ability to take Action:

        ```typescript
        import { Turnkey } from '@turnkey/sdk-server'
        import { actions, USDC, ExampleMarket } from './config'

        const turnkeyClient = new Turnkey({
          apiBaseUrl: 'https://api.turnkey.com',
          apiPublicKey: process.env.TURNKEY_API_KEY,
          apiPrivateKey: process.env.TURNKEY_API_SECRET,
          defaultOrganizationId: process.env.TURNKEY_ORGANIZATION_ID,
        })

        // Create Turnkey wallet
        const turnkeyWallet = await turnkeyClient.apiClient().createWallet({
          walletName: 'ETH Wallet',
          accounts: [{
            curve: 'CURVE_SECP256K1',
            pathFormat: 'PATH_FORMAT_BIP32',
            path: "m/44'/60'/0'/0/0",
            addressFormat: 'ADDRESS_FORMAT_ETHEREUM',
          }],
        })

        // Convert to Actions wallet
        const wallet = await actions.wallet.toActionsWallet({
          organizationId: turnkeyWallet.activity.organizationId,
          signWith: turnkeyWallet.addresses[0],
        })

        // Wallet can now take action
        const receipt = await wallet.lend.openPosition({
          amount: 100,
          asset: USDC,
          ...ExampleMarket
        })
        ```

        **Configure Smart Wallets**

        Optionally, create signers for smart wallets you control:

        ```typescript
        import { Turnkey } from '@turnkey/sdk-server'
        import { actions } from './config'

        const turnkeyClient = new Turnkey({
          apiBaseUrl: 'https://api.turnkey.com',
          apiPublicKey: process.env.TURNKEY_API_KEY,
          apiPrivateKey: process.env.TURNKEY_API_SECRET,
          defaultOrganizationId: process.env.TURNKEY_ORGANIZATION_ID,
        })

        // Create Turnkey wallet
        const turnkeyWallet = await turnkeyClient.apiClient().createWallet({
          walletName: 'ETH Wallet',
          accounts: [{
            curve: 'CURVE_SECP256K1',
            pathFormat: 'PATH_FORMAT_BIP32',
            path: "m/44'/60'/0'/0/0",
            addressFormat: 'ADDRESS_FORMAT_ETHEREUM',
          }],
        })

        // Create signer
        const signer = await actions.wallet.createSigner({
          organizationId: turnkeyWallet.activity.organizationId,
          signWith: turnkeyWallet.addresses[0],
        })

        // Create smart wallet
        const { wallet } = await actions.wallet.createSmartWallet({
          signer: signer
        })
        ```
      </Tab>
    </Tabs>
  </Tab>
</Tabs>

## Create your ActionsConfig

Create your Actions configuration to define which protocols, chains, and assets to support.

Configure a wallet provider:

```typescript
import type { WalletConfig } from '@eth-optimism/actions-sdk'

const walletConfig: WalletConfig = {
  hostedWalletConfig: {
    provider: {
      type: 'privy', // your provider chosen in previous step
    },
  },
  smartWalletConfig: {
    provider: {
      type: 'default',
      attributionSuffix: 'actions',
    },
  },
}
```

Configure a lend provider with `LendConfig`:

```typescript
import type { LendConfig } from '@eth-optimism/actions-sdk'
import { USDC, ETH, WBTC } from '@eth-optimism/actions-sdk/assets'
import { USDCMorphoMarket } from './actions/markets'

const lendConfig: LendConfig = {
  type: 'morpho',
  assetAllowlist: [USDC, ETH, WBTC],
  assetBlocklist: [],
  marketAllowlist: [USDCMorphoMarket],
  marketBlocklist: [],
}
```

Configure a borrow provider with `BorrowConfig`:

```typescript
import type { BorrowConfig } from '@eth-optimism/actions-sdk'
import { USDC, ETH, WBTC } from '@eth-optimism/actions-sdk/assets'
import { USDCMorphoMarket } from './actions/markets'

const borrowConfig: BorrowConfig = {
  type: 'morpho',
  assetAllowlist: [USDC, ETH, WBTC],
  assetBlocklist: [],
  marketAllowlist: [USDCMorphoMarket],
  marketBlocklist: [],
}
```

Configure a swap provider with `SwapConfig`:

```typescript
import type { SwapConfig } from '@eth-optimism/actions-sdk'
import { USDC, ETH, WBTC } from '@eth-optimism/actions-sdk/assets'

const swapConfig: SwapConfig = {
  type: 'uniswap',
  defaultSlippage: 100, // 100 bips or 1%
  assetAllowList: [USDC, ETH, WBTC],
  assetBlocklist: [],
}
```

Configure supported chains:

```typescript
import { optimism, base } from 'viem/chains'

// Define any EVM chain
const OPTIMISM = {
  chainId: optimism.id,
  rpcUrls: env.OPTIMISM_RPC_URL,
  bundler: { // Bundle and sponsor txs with a gas paymaster
    type: 'simple' as const,
    url: env.OPTIMISM_BUNDLER_URL,
  },
}

const BASE = {
  chainId: base.id,
  rpcUrls: env.BASE_RPC_URL,
  bundler: { // Bundle and sponsor txs with a gas paymaster
    type: 'simple' as const,
    url: env.BASE_BUNDLER_URL,
  },
}

const chains = [OPTIMISM, BASE]
```

Finally, bring it all together and initialize Actions:

```typescript
export const actions = createActions({
  wallet: walletConfig,
  lend: lendConfig,
  borrow: borrowConfig,
  swap: swapConfig,
  chains,
})
```

## Using Actions

Once configured, you can use Actions to perform DeFi operations:

```typescript
import { USDC, ETH, USDT } from '@eth-optimism/actions-sdk/assets'

// Fetch your preferred market for any asset
const market = actions.lend.getMarket(USDC)

// Enable asset lending in DeFi
const receipt1 = wallet.lend.openPosition({
  amount: 1,
  asset: USDC,
  ...market
})

// Manage user market positions
const position = wallet.lend.getPosition(market)

// Use lent assets as collateral
const receipt2 = wallet.borrow.openPosition({
  amount: 1,
  asset: USDT,
  ...market
})

// Swap between tokens onchain
const receipt3 = wallet.swap.execute({
  amountIn: 1,
  assetIn: USDC,
  assetOut: ETH,
})

// Easy, safe asset transfers
const receipt4 = wallet.send({
  amount: 1,
  asset: USDC,
  to: 'vitalik.eth',
})
```

## Next Steps

- Explore the [Actions Reference](/app-developers/reference/actions/actions-reference) for detailed API documentation
- Check out the [Actions demo](https://github.com/ethereum-optimism/actions) for a complete example application
- Join the [Optimism Discord](https://discord.optimism.io) for support and updates
